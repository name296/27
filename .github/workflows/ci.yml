name: ğŸ” Code Quality Check

on:
  # Pull Requestì™€ Push ì‹œ ì‹¤í–‰
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  # ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬
  quality-check:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“‚ Checkout
      uses: actions/checkout@v4
      
    - name: ğŸ” HTML êµ¬ë¬¸ ê²€ì‚¬
      run: |
        echo "ğŸ” HTML íŒŒì¼ êµ¬ë¬¸ ê²€ì‚¬ ì¤‘..."
        
        # HTML íŒŒì¼ë“¤ì„ ì°¾ì•„ì„œ ê¸°ë³¸ êµ¬ë¬¸ ê²€ì‚¬
        for file in *.html; do
          if [ -f "$file" ]; then
            echo "ğŸ“„ ê²€ì‚¬ ì¤‘: $file"
            
            # ê¸°ë³¸ HTML êµ¬ì¡° ê²€ì‚¬
            if grep -q "<!DOCTYPE html>" "$file" && \
               grep -q "<html" "$file" && \
               grep -q "<head>" "$file" && \
               grep -q "<body>" "$file"; then
              echo "âœ… $file: ê¸°ë³¸ HTML êµ¬ì¡° í™•ì¸"
            else
              echo "âš ï¸ $file: ê¸°ë³¸ HTML êµ¬ì¡°ì— ë¬¸ì œê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤"
            fi
            
            # ë©”íƒ€ íƒœê·¸ ê²€ì‚¬
            if grep -q "<meta charset=" "$file"; then
              echo "âœ… $file: ë¬¸ì ì¸ì½”ë”© ì„¤ì •ë¨"
            else
              echo "âš ï¸ $file: ë¬¸ì ì¸ì½”ë”©ì´ ì„¤ì •ë˜ì§€ ì•ŠìŒ"
            fi
            
            # ë·°í¬íŠ¸ ë©”íƒ€ íƒœê·¸ ê²€ì‚¬
            if grep -q "viewport" "$file"; then
              echo "âœ… $file: ë·°í¬íŠ¸ ì„¤ì •ë¨"
            else
              echo "âš ï¸ $file: ë·°í¬íŠ¸ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ"
            fi
          fi
        done
        
    - name: ğŸ¨ CSS ê¸°ë³¸ ê²€ì‚¬
      run: |
        echo "ğŸ¨ CSS íŒŒì¼ ê¸°ë³¸ ê²€ì‚¬ ì¤‘..."
        
        for file in *.css; do
          if [ -f "$file" ]; then
            echo "ğŸ“„ ê²€ì‚¬ ì¤‘: $file"
            
            # CSS íŒŒì¼ í¬ê¸° í™•ì¸
            size=$(wc -c < "$file")
            echo "ğŸ“ $file í¬ê¸°: $size bytes"
            
            # ê¸°ë³¸ CSS ë¬¸ë²• ê²€ì‚¬ (ì¤‘ê´„í˜¸ ìŒ í™•ì¸)
            open_braces=$(grep -o '{' "$file" | wc -l)
            close_braces=$(grep -o '}' "$file" | wc -l)
            
            if [ "$open_braces" -eq "$close_braces" ]; then
              echo "âœ… $file: ì¤‘ê´„í˜¸ ê· í˜• ë§ìŒ ({: $open_braces, }: $close_braces)"
            else
              echo "âŒ $file: ì¤‘ê´„í˜¸ ë¶ˆê· í˜• ({: $open_braces, }: $close_braces)"
              exit 1
            fi
          fi
        done
        
    - name: âš¡ JavaScript ê¸°ë³¸ ê²€ì‚¬
      run: |
        echo "âš¡ JavaScript íŒŒì¼ ê¸°ë³¸ ê²€ì‚¬ ì¤‘..."
        
        for file in *.js; do
          if [ -f "$file" ]; then
            echo "ğŸ“„ ê²€ì‚¬ ì¤‘: $file"
            
            # JavaScript íŒŒì¼ í¬ê¸° í™•ì¸
            size=$(wc -c < "$file")
            echo "ğŸ“ $file í¬ê¸°: $size bytes"
            
            # ê¸°ë³¸ êµ¬ë¬¸ ê²€ì‚¬ (ê´„í˜¸ ìŒ í™•ì¸)
            open_parens=$(grep -o '(' "$file" | wc -l)
            close_parens=$(grep -o ')' "$file" | wc -l)
            open_braces=$(grep -o '{' "$file" | wc -l)
            close_braces=$(grep -o '}' "$file" | wc -l)
            open_brackets=$(grep -o '\[' "$file" | wc -l)
            close_brackets=$(grep -o '\]' "$file" | wc -l)
            
            echo "ğŸ” ê´„í˜¸ ê²€ì‚¬:"
            echo "  - ì†Œê´„í˜¸: ( $open_parens | ) $close_parens"
            echo "  - ì¤‘ê´„í˜¸: { $open_braces | } $close_braces"
            echo "  - ëŒ€ê´„í˜¸: [ $open_brackets | ] $close_brackets"
            
            if [ "$open_parens" -eq "$close_parens" ] && \
               [ "$open_braces" -eq "$close_braces" ] && \
               [ "$open_brackets" -eq "$close_brackets" ]; then
              echo "âœ… $file: ê´„í˜¸ ê· í˜• ë§ìŒ"
            else
              echo "âŒ $file: ê´„í˜¸ ë¶ˆê· í˜• ë°œê²¬"
              exit 1
            fi
          fi
        done
        
    - name: ğŸ“Š í”„ë¡œì íŠ¸ í†µê³„
      run: |
        echo "ğŸ“Š í”„ë¡œì íŠ¸ íŒŒì¼ í†µê³„:"
        echo "----------------------------------------"
        
        # íŒŒì¼ ê°œìˆ˜
        html_count=$(ls *.html 2>/dev/null | wc -l)
        css_count=$(ls *.css 2>/dev/null | wc -l)
        js_count=$(ls *.js 2>/dev/null | wc -l)
        svg_count=$(ls *.svg 2>/dev/null | wc -l)
        
        echo "ğŸ“„ HTML íŒŒì¼: $html_countê°œ"
        echo "ğŸ¨ CSS íŒŒì¼: $css_countê°œ"
        echo "âš¡ JavaScript íŒŒì¼: $js_countê°œ"
        echo "ğŸ–¼ï¸ SVG íŒŒì¼: $svg_countê°œ"
        
        # ì´ ì½”ë“œ ë¼ì¸ ìˆ˜
        total_lines=0
        if [ "$html_count" -gt 0 ]; then
          html_lines=$(cat *.html | wc -l)
          echo "ğŸ“ HTML ì´ ë¼ì¸: $html_lines"
          total_lines=$((total_lines + html_lines))
        fi
        
        if [ "$css_count" -gt 0 ]; then
          css_lines=$(cat *.css | wc -l)
          echo "ğŸ“ CSS ì´ ë¼ì¸: $css_lines"
          total_lines=$((total_lines + css_lines))
        fi
        
        if [ "$js_count" -gt 0 ]; then
          js_lines=$(cat *.js | wc -l)
          echo "ğŸ“ JavaScript ì´ ë¼ì¸: $js_lines"
          total_lines=$((total_lines + js_lines))
        fi
        
        echo "ğŸ“ ì´ ì½”ë“œ ë¼ì¸: $total_lines"
        echo "----------------------------------------"
        
    - name: âœ… ê²€ì‚¬ ì™„ë£Œ
      run: |
        echo "ğŸ‰ ëª¨ë“  ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
        echo "âœ… í”„ë¡œì íŠ¸ê°€ ë°°í¬ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤."
